{% extends 'treasuremap/base_treasuremap.html' %}
{% import "bootstrap_wtf.html" as wtf %}

{% block content %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Escena</title>
    <style>
        /* body {
            font-size: {{ scene.font_size }};
            font-family: {{ scene.font_family }};
        } */
    </style>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <p>{{ scene.text }}</p>
    {% for group in scene.groups %}
        <p>{{ group.question }}</p>
        <p>{{ group.answer }}</p>
    {% endfor %}
    
    <button onclick="addTime()">Add time</button>
    <button onclick="stopTime()">Stop time</button>
    <button onclick="resumeTime()">Resume time</button>
    <button onclick="substractTime()">Substract time</button>
    <button onclick="advanceScene()">Advance scene</button>
    <button onclick="retraceScene()">Retrace scene</button>
    <button onclick="showOctocorn()">Show octocorn</button>
    <button onclick="hideOctocorn()">Hide octocorn</button>
    <button onclick="restart()">Restart</button>

{% endblock %}

{% block scripting %}
<script>
    function showOctocorn() {
        fetch('/treasuremap/show_octocorn_help');
    }
    
    function hideOctocorn() {
        fetch('/treasuremap/hide_octocorn_help');
    }
    
    function advanceScene() {
        fetch('/treasuremap/advance_scene');
    }
    
    function retraceScene() {
        fetch('/treasuremap/retrace_scene');
    }
    
    function addTime() {
        fetch('/treasuremap/add_time');
    }
    
    function stopTime() {
        fetch('/treasuremap/stop_time');
    }
    
    function resumeTime() {
        fetch('/treasuremap/resume_time');
    }
    
    function substractTime() {
        fetch('/treasuremap/substract_time');
    }

    function restart() {
        fetch('/treasuremap/start');
    }

    function updateCountdown() {
        fetch('/treasuremap/countdown')
            .then(response => response.text())
            .then(data => {
                document.getElementById('countdown').innerText = data;
            });
    }
    setInterval(updateCountdown, 1000);
    
    function checkReload() {
                      fetch('/treasuremap/needs_redirect')
                          .then(response => response.json())
                          .then(data => {
                              if (data.needs_redirect_admin) {
                                  window.location.href = "/treasuremap/admin";
                              }
                          })
                          .catch(error => console.error("Error:", error));
    }
    setInterval(checkReload, 1000);  
             


</script>
{% endblock %}